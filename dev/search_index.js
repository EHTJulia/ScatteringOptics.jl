var documenterSearchIndex = {"docs":
[{"location":"math/","page":"Background","title":"Background","text":"CurrentModule = ScatteringOptics","category":"page"},{"location":"math/#Background","page":"Background","title":"Background","text":"","category":"section"},{"location":"math/","page":"Background","title":"Background","text":"ScatteringOptics.jl implements a single thin-screen scattering model (described in  [1] and [2]) that simulates both diffractive and refractive scattering. In many instances, the properties of the interstellar scattering can be well described by a single, thin phase-changing screen phi_r(r), where r is a transverse coordinate on the screen. The statistical characteristics of scattering can be described by those of the phase screen through its spatial structure function D_phi(r).","category":"page"},{"location":"math/","page":"Background","title":"Background","text":"Diffractive scattering causes the angular broadening of the source image.  The diffractively scattered image I_ea(r) is mathematically given by the convolution of the source image I_src(r) with a blurring scattering kernel, G(r), ","category":"page"},{"location":"math/","page":"Background","title":"Background","text":"I_ea(r) = I_src(r) * G(r)","category":"page"},{"location":"math/","page":"Background","title":"Background","text":"where r refers to the two-dimensional phase screen coordinate vector. In radio interferometry, each set of measurements, so-called visibilities, obtained with a pair of antennas at different time and frequency segments, samples a Fourier component of the sky image. The source visibilities, V_src(b), are related to the diffractively scattered visibilities, V_ea(b), by,","category":"page"},{"location":"math/","page":"Background","title":"Background","text":"V_ea(b) = V_src(b)textexpleft-frac12 D_phileft(fracb1+Mright)right","category":"page"},{"location":"math/","page":"Background","title":"Background","text":"in which b is the baseline vector between observing stations. The magnification M=DR is the ratio of earth-screen distance D to screen-source distance R. ","category":"page"},{"location":"math/","page":"Background","title":"Background","text":"Refractive scattering further introduces compact substructures on the diffractively-scattered, angular-broadened images.  The compact substructures arise from phase gradients on the scattering screen nabla phi_r(r). The refractively scattered image I_a(r) is given by","category":"page"},{"location":"math/","page":"Background","title":"Background","text":"I_a(r) approx I_ea(r) (r + r_F^2 nabla phi_r(r))","category":"page"},{"location":"math/","page":"Background","title":"Background","text":"in which the Fresnel scale, r_F = sqrtfracDRD+Rfraclambda2pi is dependent on the observing wavelength lambda [@JohnsonNarayan2016]. ","category":"page"},{"location":"math/","page":"Background","title":"Background","text":"ScatteringOptics.jl implements three analytic probabilistic models for the phase screen phi_r(r), named Dipole, Periodic Boxcar, and Von Mises models in @Psaltis2018, providing the corresponding semi-analytic descriptions of the phase structure function D\\phi(r)$. The default model is the Dipole model, known to be consistent with multi-frequency measurements of Sgr A* [1].","category":"page"},{"location":"math/#References","page":"Background","title":"References","text":"","category":"section"},{"location":"math/","page":"Background","title":"Background","text":"[1] M. D. Johnson. Stochastic optics: A scattering mitigation framework for radio interferometric imaging. The Astrophysical Journal, 833(1):74, dec 2016. DOI: 10.3847/1538-4357/833/1/74.","category":"page"},{"location":"math/","page":"Background","title":"Background","text":"[2] D. Psaltis, M. Johnson, R. Narayan, L. Medeiros, L. Blackburn, and G. Bower. A model for anisotropic interstellar scattering and its application to sgr a*, 2018.","category":"page"},{"location":"math/","page":"Background","title":"Background","text":"[3] Johnson, M. D., & Narayan, R. (2016). The Optics of Refractive Substructure. 826(2), 170. DOI:10.3847/0004-637X/826/2/170","category":"page"},{"location":"","page":"Home","title":"Home","text":"CurrentModule = ScatteringOptics","category":"page"},{"location":"#ScatteringOptics","page":"Home","title":"ScatteringOptics","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"ScatteringOptics implements the 'Stochastic Optics' scattering mitigation framework [1] to produce realistic scattering on an input EHT model. The module addressed two distinctive forms of scattering–diffractive blurring and refractive scintillation–independently and then integrates them to output a fully scattered model via the scatter() function.","category":"page"},{"location":"#Diffractive-Kernel","page":"Home","title":"Diffractive Kernel","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Users can instantiate a diffractive scattering kernel model and convolve input images to generate diffractive blurring effects. The module provides three different diffractive scattering probabilistic models: Dipole, Boxcar, and Von Mises. Users construct a model of choice which can generate a scattering kernel for convolution of the model image.","category":"page"},{"location":"#Refractive-Phase-Screen","page":"Home","title":"Refractive Phase Screen","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"A RefractivePhaseScreen object automatically generates a refractive power law function from the scattering model parameters, to be used in generating a phase screen. The model implements power law noise generation provided by the package StationaryRandomFields.","category":"page"},{"location":"#References","page":"Home","title":"References","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"[1] M. D. Johnson. Stochastic optics: A scattering mitigation framework for radio interferometric imaging. The Astrophysical Journal, 833(1):74, dec 2016. doi: 10.3847/1538-4357/833/1/74.","category":"page"},{"location":"autodocs/","page":"ScateringOptics.jl API","title":"ScateringOptics.jl API","text":"CurrentModule = ScatteringOptics","category":"page"},{"location":"autodocs/#ScateringOptics.jl-API","page":"ScateringOptics.jl API","title":"ScateringOptics.jl API","text":"","category":"section"},{"location":"autodocs/#Index","page":"ScateringOptics.jl API","title":"Index","text":"","category":"section"},{"location":"autodocs/","page":"ScateringOptics.jl API","title":"ScateringOptics.jl API","text":"","category":"page"},{"location":"autodocs/#Docstrings","page":"ScateringOptics.jl API","title":"Docstrings","text":"","category":"section"},{"location":"autodocs/","page":"ScateringOptics.jl API","title":"ScateringOptics.jl API","text":"Modules = [ScatteringOptics]","category":"page"},{"location":"autodocs/#ScatteringOptics.Params_Johnson2018","page":"ScateringOptics.jl API","title":"ScatteringOptics.Params_Johnson2018","text":"Best-fit parameters of the dipole scattering model derived in Johnson et al. 2018\n\n\n\n\n\n","category":"constant"},{"location":"autodocs/#ScatteringOptics.AbstractKzetaFinder","page":"ScateringOptics.jl API","title":"ScatteringOptics.AbstractKzetaFinder","text":"AbstractKzetaFinder\n\nThis is an abstract data type to set up equations and provide a solver for the concentration parameter k_ζ for an anistropic interstellar scattering model. See Psaltis et al. 2018, arxiv::1805.01242v1 for details.\n\nMandatory methods\n\nkzetafinder_equation(kzeta, finder::AbstractKzetaFinder): should privide a equation where k will be derived.\n\nMethods provided\n\nfindkzeta_exact(finder::AbstractKzetaFinder): solves the equation for k_ζ,2 given the set of parameters in the finder.\n\n\n\n\n\n","category":"type"},{"location":"autodocs/#ScatteringOptics.AbstractScatteringKernel","page":"ScateringOptics.jl API","title":"ScatteringOptics.AbstractScatteringKernel","text":"abstract type AbstractScatteringKernel{T} <: ComradeBase.AbstractModel\n\nAn abstract Comrade Sky Model for the diffractive scattering kernel. These are usually primitive models, and are usually analytic in Fourier but not analytic in the image domain. As a result a user only needs to implement the following methods.\n\nvisibility_point\nradialextent\n\n\n\n\n\n","category":"type"},{"location":"autodocs/#ScatteringOptics.AbstractScatteringModel","page":"ScateringOptics.jl API","title":"ScatteringOptics.AbstractScatteringModel","text":"abstract type AbstractScatteringModel\n\nAn abstract anistropic scattering model based on a thin-screen approximation. In this package, we provide a reference implementation of the dipole (DipoleScatteringModel), von Mises (vonMisesScatteringModel) and periodic Box Car models (PeriodicBoxCarScatteringModel) all introduced in Psaltis et al. 2018.\n\nMandatory fields The scattering model will be fundamentally governed by the following parameters. Ideally, a subtype of this abstract model should have a constructor only with these arguments.\n\nα::Number: The power-law index of the phase fluctuations (Kolmogorov is 5/3).\nrin::Number: The inner scale of the scattering screen in cm.\nθmaj::Number: FWHM in mas of the major axis angular broadening at the specified reference wavelength.\nθmin::Number: FWHM in mas of the minor axis angular broadening at the specified reference wavelength.\nϕ::Number: The position angle of the major axis of the scattering in degree.\nλ0::Number: The reference wavelength for the scattering model in cm.\nD::Number: The distance from the observer to the scattering screen in cm.\nR::Number: The distance from the source to the scattering screen in cm.\n\nFurthermore the following parameters need to be precomputed.\n\nM::Number: Magnification parameter, defined as D/R\nζ0::Number: \nA::Number:\nkζ::Number\nBmaj::Number:\nBmin::Number:\nQbar::Number:\nC::Number:\nAmaj::Number:\nAmin::Number:\nϕ0::Number:\n\n\n\n\n\n","category":"type"},{"location":"autodocs/#ScatteringOptics.ApproximatedScatteringKernel","page":"ScateringOptics.jl API","title":"ScatteringOptics.ApproximatedScatteringKernel","text":"struct ApproximatedScatteringKernel{T, S, N} <: AbstractScatteringKernel{T}\n\nA Comrade VLBI Sky Model for the scattering kernel based on a Scattering Model sm <: AbstractScatteringModel using the fast approximation formula in Psaltis et al. (2018).\n\nIf T isn't given, T defaults to Float64\n\n\n\n\n\n","category":"type"},{"location":"autodocs/#ScatteringOptics.DipoleScatteringModel","page":"ScateringOptics.jl API","title":"ScatteringOptics.DipoleScatteringModel","text":"struct DipoleScatteringModel{T<:Number} <: AbstractScatteringModel\n\nAn anistropic scattering model based on a thin-screen approximation. This scattering model adopts the dipole field wonder described in Psaltis et al. 2018.\n\n** Keywords for the constructor ** The default numbers are based on the best-fit parameters presented in Johnson et al. 2018.\n\nα::Number: The power-law index of the phase fluctuations (Kolmogorov is 5/3).\nrin_cm::Number: The inner scale of the scattering screen in cm.\nθmaj_mas::Number: FWHM in mas of the major axis angular broadening at the specified reference wavelength.\nθmin_nas::Number: FWHM in mas of the minor axis angular broadening at the specified reference wavelength.\nϕ_deg::Number: The position angle of the major axis of the scattering in degree.\nλ0_cm::Number: The reference wavelength for the scattering model in cm.\nD_kpc::Number: The distance from the observer to the scattering screen in kpc.\nR_kpc::Number: The distance from the source to the scattering screen in kpc.\n\n\n\n\n\n","category":"type"},{"location":"autodocs/#ScatteringOptics.Dipole_KzetaFinder","page":"ScateringOptics.jl API","title":"ScatteringOptics.Dipole_KzetaFinder","text":"struct Dipole_KzetaFinder{T<:Number} <: ScatteringOptics.AbstractKzetaFinder\n\nThe finder of the concentration parameter kζ,2 for dipole anistropic scattering models. See Psaltis et al. 2018, arxiv::1805.01242v1 for details. The equation for kζ,2 is given by the equation 43 of Psaltis et al. 2018.\n\nMandatory fields\n\nα::Number: The power-law index of the phase fluctuations (Kolmogorov is 5/3).\nA::Number: The anisotropy parameter of the angular broaderning defined by θmaj/θmin.\n\n\n\n\n\n","category":"type"},{"location":"autodocs/#ScatteringOptics.ExactScatteringKernel","page":"ScateringOptics.jl API","title":"ScatteringOptics.ExactScatteringKernel","text":"struct ExactScatteringKernel{T, S, N} <: AbstractScatteringKernel{T}\n\nA Comrade VLBI Sky Model for the scattering kernel based on a Scattering Model sm <: AbstractScatteringModel using the exact formula in Psaltis et al. (2018).\n\nBy default if T isn't given, T defaults to Float64\n\n\n\n\n\n","category":"type"},{"location":"autodocs/#ScatteringOptics.PeriodicBoxCarScatteringModel","page":"ScateringOptics.jl API","title":"ScatteringOptics.PeriodicBoxCarScatteringModel","text":"struct PeriodicBoxCarScatteringModel{T<:Number} <: AbstractScatteringModel\n\nAn anistropic scattering model based on a thin-screen approximation. This scattering adopts the periodic boxcar field wonder described in Psaltis et al. 2018.\n\n** Keywords for the constructor ** The default numbers are based on the best-fit parameters presented in Johnson et al. 2018.\n\nα::Number: The power-law index of the phase fluctuations (Kolmogorov is 5/3).\nrin_cm::Number: The inner scale of the scattering screen in cm.\nθmaj_mas::Number: FWHM in mas of the major axis angular broadening at the specified reference wavelength.\nθmin_nas::Number: FWHM in mas of the minor axis angular broadening at the specified reference wavelength.\nϕ_deg::Number: The position angle of the major axis of the scattering in degree.\nλ0_cm::Number: The reference wavelength for the scattering model in cm.\nD_kpc::Number: The distance from the observer to the scattering screen in pc.\nR_kpc::Number: The distance from the source to the scattering screen in pc.\n\n\n\n\n\n","category":"type"},{"location":"autodocs/#ScatteringOptics.PeriodicBoxCar_KzetaFinder","page":"ScateringOptics.jl API","title":"ScatteringOptics.PeriodicBoxCar_KzetaFinder","text":"struct PeriodicBoxCar_KzetaFinder{T<:Number} <: ScatteringOptics.AbstractKzetaFinder\n\nThe finder of the concentration parameter kζ,3 for the Periodic Box Car anistropic scattering model. See Psaltis et al. 2018, arxiv::1805.01242v1 for details. The equation for kζ,3 is given by the equation 47 of Psaltis et al. 2018.\n\nMandatory fields\n\nA::Number: The anisotropy parameter of the angular broaderning defined by θmaj/θmin.\n\n\n\n\n\n","category":"type"},{"location":"autodocs/#ScatteringOptics.PhaseScreenPowerLaw","page":"ScateringOptics.jl API","title":"ScatteringOptics.PhaseScreenPowerLaw","text":"$(TYPEDEF)\n\nPower spectrum model of ISM fluctuations, for use in generating a RefractivePhaseScreen object.  Requires an AbstractScatteringModel for scattering parameters as well as image x and y pixel sizes. Optional  input of velocity in x and y direction for moving phase screen.\n\nFields\n\nFIELDS\n\n\n\n\n\n","category":"type"},{"location":"autodocs/#ScatteringOptics.vonMisesScatteringModel","page":"ScateringOptics.jl API","title":"ScatteringOptics.vonMisesScatteringModel","text":"struct vonMisesScatteringModel{T<:Number} <: AbstractScatteringModel\n\nAn anistropic scattering model based on a thin-screen approximation. This scattering adopts the von Mises field wonder described in Psaltis et al. 2018.\n\n** Keywords for the constructor ** The default numbers are based on the best-fit parameters presented in Johnson et al. 2018.\n\nα::Number: The power-law index of the phase fluctuations (Kolmogorov is 5/3).\nrin_cm::Number: The inner scale of the scattering screen in cm.\nθmaj_mas::Number: FWHM in mas of the major axis angular broadening at the specified reference wavelength.\nθmin_nas::Number: FWHM in mas of the minor axis angular broadening at the specified reference wavelength.\nϕ_deg::Number: The position angle of the major axis of the scattering in degree.\nλ0_cm::Number: The reference wavelength for the scattering model in cm.\nD_kpc::Number: The distance from the observer to the scattering screen in pc.\nR_kpc::Number: The distance from the source to the scattering screen in pc.\n\n\n\n\n\n","category":"type"},{"location":"autodocs/#ScatteringOptics.vonMises_KzetaFinder","page":"ScateringOptics.jl API","title":"ScatteringOptics.vonMises_KzetaFinder","text":"struct vonMises_KzetaFinder{T<:Number} <: ScatteringOptics.AbstractKzetaFinder\n\nThe finder of the concentration parameter kζ,1 for the von Mises anistropic scattering model. See Psaltis et al. 2018, arxiv::1805.01242v1 for details. The equation for kζ,1 is originally given by the equation 37 of Psaltis et al. 2018, but this is different in the implementation of Johnson et al. 2018 in eht-imaging library. We follow eht-imaging's implementation.\n\nMandatory fields\n\nA::Number: The anisotropy parameter of the angular broaderning defined by θmaj/θmin.\n\n\n\n\n\n","category":"type"},{"location":"autodocs/#ScatteringOptics.Dϕ_approx-Tuple{AbstractScatteringModel, Number, Number, Number}","page":"ScateringOptics.jl API","title":"ScatteringOptics.Dϕ_approx","text":"Dϕ_approx(sm::AbstractScatteringModel, λ::Number, x::Number, y::Number)\n\nMasm approximate phase structure function Dϕ(r, ϕ) at observing wavelength λ, first converting x and y into polar coordinates. Based on Equation 35 of Psaltis et al. 2018.\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#ScatteringOptics.Dϕ_exact-Tuple{AbstractScatteringModel, Number, Number, Number}","page":"ScateringOptics.jl API","title":"ScatteringOptics.Dϕ_exact","text":"Dϕ_exact(sm::AbstractScatteringModel, λ::Number, x::Number, y::Number)\n\nMasm exact phase structure function Dϕ(r, ϕ) at observing wavelength λ, first converting x and y into the polar coordinates\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#ScatteringOptics.calc_Dmaj-Tuple{AbstractScatteringModel, Number, Number}","page":"ScateringOptics.jl API","title":"ScatteringOptics.calc_Dmaj","text":"Dmaj(r, sm::AbstractScatteringModel)\n\nMasm D_maj(r) for given r. Based on Equation 33 of Psaltis et al. 2018\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#ScatteringOptics.calc_Dmin-Tuple{AbstractScatteringModel, Number, Number}","page":"ScateringOptics.jl API","title":"ScatteringOptics.calc_Dmin","text":"calc_Dmin(r, sm::AbstractScatteringModel)\n\nMasm D_min(r) for given r. Based on Equation 34 of Psaltis et al. 2018\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#ScatteringOptics.dDϕ_dz-Tuple{AbstractScatteringModel, Number, Number, Number, Any}","page":"ScateringOptics.jl API","title":"ScatteringOptics.dDϕ_dz","text":"dDϕ_dz(sm::AbstractScatteringModel, λ::Number, r::Number, ϕ::Number, ϕq)\n\nDifferential contribution to the phase structure function.\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#ScatteringOptics.findkzeta_exact-Tuple{ScatteringOptics.AbstractKzetaFinder}","page":"ScateringOptics.jl API","title":"ScatteringOptics.findkzeta_exact","text":"findkzeta_exact(finder::AbstractKzetaFinder; kwargs...)\n\nSolves the equation for the concentration parameter k_ζ,2 given the set of parameters in the finder. It uses NonlinearSolve.jl.\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#ScatteringOptics.get_rF-Tuple{AbstractPhaseScreen, Number}","page":"ScateringOptics.jl API","title":"ScatteringOptics.get_rF","text":"get_rF(psm::AbstractPhaseScreen, λ_cm)\n\nReturns Fresnel scale corresponding to the given AvstractPhaseScreen object and observing wavelength, λ_cm\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#ScatteringOptics.image_scatter-Tuple{AbstractPhaseScreen, Any, Number}","page":"ScateringOptics.jl API","title":"ScatteringOptics.image_scatter","text":"image_scatter(psm::RefractivePhaseScreen, imap, λ_cm::Number; νref::Number = c_cgs)\n\nImplements full ISM scattering on an unscattered Comrade skymodel intensity map (imap). Diffrective blurring and  refractive phase screen generation are specific to the scattering parameters defined in the AbstractPhaseScreen model psm. The observing wavelength λ_cm is required.\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#ScatteringOptics.kernelmodel-Tuple{AbstractScatteringModel}","page":"ScateringOptics.jl API","title":"ScatteringOptics.kernelmodel","text":"kernelmodel(sm::AbstractScatteringModel; νref::Number=c_cgs, use_approx::Bool == true)\n\nReturn a Comrade Sky Model for the diffractive scattering kernel of the input scattering model.\n\n** Keyword Argurments **\n\nνref::Number:   the reference frequency in Hz to give a radial extent of the kernel,   which is ideally the lowest frequency of your data sets as the kenerl size is roughly scale with λ^2.   νref defaults to the light speed in cgs unit, providing the wavelength of 1 cm.\nuse_approx::Bool==true:   if true, returns a model using the approximated fourmula to compute visibiltiies (ScatteringKernel).   Otherwise, return a model instead using the exact formula (ExactScatteringKernel).\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#ScatteringOptics.kzetafinder_equation-Tuple{Any, ScatteringOptics.AbstractKzetaFinder}","page":"ScateringOptics.jl API","title":"ScatteringOptics.kzetafinder_equation","text":"kzetafinder_equation(kzeta, finder::AbstractKzetaFinder)\n\nThis equation privide a root-finding function f(kzeta, finder) to find kzeta from the equation f(kzeta, finder)=0.\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#ScatteringOptics.phase_screen","page":"ScateringOptics.jl API","title":"ScatteringOptics.phase_screen","text":"phase_screen(psm::AbstractPhaseScreen, λ_cm, noise_screen=nothing)\n\nGenerates a refractive phase screen, ϕ, using StationaryRandomFields.jl the power law noise procedure.  The fourier space 2D noisescreen (defaults to gaussian noise screen if not given) is scaled by the power law, Q, defined in input AbstractPhaseScreen psm. The observing wavelength, `λcm`, must be given.\n\n\n\n\n\n","category":"function"},{"location":"autodocs/#ScatteringOptics.visibility_point_approx-Tuple{AbstractScatteringModel, Number, Number, Number}","page":"ScateringOptics.jl API","title":"ScatteringOptics.visibility_point_approx","text":"visibility_point_approx(sm::AbstractScatteringModel, λ::Number, u::Number, v::Number)\n\nCompute the diffractive kernel for a given observing wavelength λ and fourier space coordinates u, v using the approximated formula of the phase structure function.\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#ScatteringOptics.visibility_point_exact-Tuple{AbstractScatteringModel, Number, Number, Number}","page":"ScateringOptics.jl API","title":"ScatteringOptics.visibility_point_exact","text":"visibility_point_exact(sm::AbstractScatteringModel, λ::Number, u::Number, v::Number)\n\nCompute the diffractive kernel for a given observing wavelength λ and fourier space coordinates u, v using the exact formula of the phase structure function.\n\n\n\n\n\n","category":"method"},{"location":"autodocs/#ScatteringOptics.wrapped_grad-Tuple{Any, Any, Any}","page":"ScateringOptics.jl API","title":"ScatteringOptics.wrapped_grad","text":"wrapped_grad(ϕ, dx, dy)\n\nReturns the wrapped gradient of a given 2D phase screen. The x and y pixel sizes (dx and dy) must be given.\n\n\n\n\n\n","category":"method"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"CurrentModule = ScatteringOptics","category":"page"},{"location":"tutorial/#Tutorial","page":"Tutorial","title":"Tutorial","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"This example code segment uses ScatteringOptics.jl to simulate interstellar scattering on an input Comrade.jl SkyModel object via the image_scatter() function.","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"using ScatteringOptics\nusing EHTImages\nusing PythonPlot\nusing EHTUtils\n\n# Load a model image FITS file\nim = load_fits(\"jason_mad_eofn.fits\")\n# Initialize a comrade SkyModel from the loaded image\nimap = intensitymap(im)\n# Plot source image\nimshow(im, angunit=EHTUtils.μas)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"(Image: fig)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Optionally, users can retrieve a purely diffractive scattering ensemble average image with the convolve function in VLBISkyModels.jl.","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"# Initialize a scattering model with desired scattering paramaters, otherwise default ISM parameters are used\n# The default model is a Dipole model\nsm = ScatteringModel()\n\n# Create kernel from scattering model\nskm = kernelmodel(sm, νref=230e9)\n\n# Convolve to get the ensemble averaged image\nusing VLBISkyModels\nimap_ea = convolve(imap, skm)\n\n# Map and plot convolved image\nim_ea = copy(im)\nmap!(im_ea, imap_ea)\nimshow(im_ea, angunit=EHTUtils.μas)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"(Image: fig)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Otherwise, the scattering kernel skm is not required to obtain a fully scattered image. A RefractivePhaseScreen type object may be initialized from the ScatteringModel and image dimensions. ","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"# Create a refractive phase screen model from scattering model and image dimensions\nnx, ny = size(imap) \ndx = imap.X.step.hi  # pixel size in radians\ndy = imap.Y.step.hi \nrps = RefractivePhaseScreen(sm, nx, ny, dx, dy) # sm is the scattering model\n\n# Produce scattered image with observing wavelength .13 cm\ns = image_scatter(rps, imap, 0.13, νref=230e9)\n\n# Load and plot scattered image\nim_sc = load(s)\nim_sc.f[1] = 230e9\nimshow(im_sc, angunit=EHTUtils.μas)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"(Image: fig)","category":"page"}]
}
